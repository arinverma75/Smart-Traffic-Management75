# Render.com service definition for Smart Traffic Management
# When you connect your GitHub repo to Render and enable "Deploy with a render.yaml file",
# this configuration automatically creates the web service with the correct settings.

services:
  - type: web
    name: smart-traffic-management
    env: python
    plan: free                  # or change to "starter"/"standard" etc.
    # if you prefer to use the Dockerfile, change env to "docker" and omit buildCommand
    buildCommand: "pip install -r requirements.txt"
    startCommand: "uvicorn app.main:app --host 0.0.0.0 --port $PORT"
    envVars:
      - key: GOOGLE_MAPS_API_KEY
        sync: false           # Set this manually in the Render dashboard
      - key: YOLO_MODEL
        value: yolov8n.pt     # Default YOLO model; override in dashboard if needed
      - key: HELMET_MODEL
        sync: false           # Set this manually in the Render dashboard (leave blank to disable)
      # Render automatically provides a PORT variable at runtime
    autoDeploy: true
    # optionally set health check path to /api/health
    healthCheckPath: "/api/health"
